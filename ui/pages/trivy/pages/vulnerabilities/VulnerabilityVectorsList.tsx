import React from 'react';

import Chip from '@mui/joy/Chip';
import Divider from '@mui/joy/Divider';
import List from '@mui/joy/List';
import ListDivider from '@mui/joy/ListDivider';
import ListItem from '@mui/joy/ListItem';
import ListItemContent from '@mui/joy/ListItemContent';
import Sheet from '@mui/joy/Sheet';
import Typography from '@mui/joy/Typography';
import Tooltip from '@mui/joy/Tooltip';
import { parseCvssVector } from './utils';

type Props = {
  vector: string;
};

export const VulnerabilityVectorsList: React.FC<Props> = ({ vector }) => {
  return (
    <Sheet variant="outlined" sx={{ borderRadius: 'sm' }}>
      <Typography p={1.5} level="title-sm" fontWeight={700} component="div">
        CVSS Vector
      </Typography>
      <Divider />
      <List size='sm'>
        {parseCvssVector(vector).map((display, index, arr) => (
          <>
            <ListItem key={index}>
              <ListItemContent
                sx={{
                  px: 0.5,
                  display: 'flex',
                  justifyContent: 'space-between',
                  alignItems: 'center',
                }}
              >
                <Typography level="body-sm" component="div">
                  {display.metric}
                </Typography>
                <Tooltip title={display.description}>
                  <Chip variant='soft' color='neutral' sx={{ borderRadius: 'sm' }}>
                    {display.value}
                  </Chip>
                </Tooltip>
              </ListItemContent>
            </ListItem>
            {index < arr?.length - 1 && <ListDivider />} 
          </>
        ))}
      </List>
    </Sheet>
  );
};

export default VulnerabilityVectorsList;
